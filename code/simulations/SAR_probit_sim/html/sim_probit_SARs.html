
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>sim_probit_SARs</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-09-22"><meta name="DC.source" content="sim_probit_SARs.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">% Simulate a probit SAR model</span>
<span class="comment">% Input is a graph matrix (W) that was generated in R using network_sim.Rmd</span>
<span class="comment">% y* := Pr[y=1|x] = F(x'beta)</span>
<span class="comment">% i = random binary vector</span>
<span class="comment">% Y := round((y* * i))</span>

<span class="comment">% x = [capital liquidity shortFunding]</span>

load(<span class="string">'..\SAR_sim\Ws.mat'</span>)
Ws(1) = s1
Ws(2) = s2
Ws(3) = s3

<span class="keyword">for</span> i=1:length(Ws)
    sims(i) = sim_probit_SAR(Ws(i).W)
<span class="keyword">end</span>

save(<span class="string">'sims_probit_SAR_Wfull.mat'</span>,<span class="string">'sims'</span>)

<span class="keyword">function</span> sim = sim_probit_SAR(W)
    N = size(W, 1)

    <span class="comment">%normalize W</span>
    <span class="keyword">for</span> i=1:size(W,1)
        <span class="keyword">if</span> sum(W(i,:))~=0
            W(i,:) = W(i,:)/sum(W(i,:));
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    rng(31, <span class="string">'twister'</span>);
    capital = unifrnd(0.08, 0.30, [N 1]);
    liquidity = unifrnd(0.01, 0.35, [N 1]);
    shortFunding = unifrnd(0.01, 0.40, [N 1]);
    X = [ones(N, 1) capital liquidity shortFunding]
    rho = -0.3
    Beta = [0.3
            -4
            -2
            3]
    Epsilon = random(<span class="string">'Normal'</span>, 0, 1, N, 1);
    I = eye(N);
    A = (I - rho*W)^(-1);
    Y_p = normcdf(A*X*Beta + A*Epsilon);

    Y = binornd(1, Y_p)

    sim.data.X = X
    sim.data.Y = Y
    sim.data.W = W
    sim.info.gamma = [Beta
                    rho]

<span class="keyword">end</span>
<span class="comment">% end simulation</span>
</pre><pre class="codeoutput">
Ws = 

  1&times;3 struct array with fields:

    W
    Wsparse


Ws = 

  1&times;3 struct array with fields:

    W
    Wsparse


Ws = 

  1&times;3 struct array with fields:

    W
    Wsparse


N =

    50


X =

    1.0000    0.1429    0.1133    0.1485
    1.0000    0.2908    0.1126    0.3947
    1.0000    0.2495    0.0125    0.3637
    1.0000    0.2971    0.2070    0.2246
    1.0000    0.1258    0.2542    0.2372
    1.0000    0.1101    0.1485    0.1964
    1.0000    0.2798    0.0654    0.1401
    1.0000    0.0951    0.0815    0.0410
    1.0000    0.0966    0.2684    0.1246
    1.0000    0.1996    0.1316    0.0339
    1.0000    0.0997    0.1416    0.1301
    1.0000    0.1641    0.2663    0.0745
    1.0000    0.2271    0.3049    0.3274
    1.0000    0.1744    0.2649    0.3580
    1.0000    0.0897    0.1451    0.3641
    1.0000    0.1227    0.1528    0.3858
    1.0000    0.1783    0.1982    0.1907
    1.0000    0.0938    0.1683    0.1929
    1.0000    0.1455    0.3029    0.3946
    1.0000    0.2876    0.2901    0.1309
    1.0000    0.1422    0.0352    0.2090
    1.0000    0.1389    0.1190    0.1028
    1.0000    0.1696    0.1529    0.1642
    1.0000    0.2617    0.2349    0.2364
    1.0000    0.1915    0.2247    0.1320
    1.0000    0.1393    0.1852    0.3868
    1.0000    0.1548    0.1302    0.3922
    1.0000    0.2944    0.0244    0.0679
    1.0000    0.1205    0.0226    0.1147
    1.0000    0.1333    0.2753    0.1883
    1.0000    0.2319    0.0713    0.0264
    1.0000    0.1645    0.1470    0.0708
    1.0000    0.1815    0.2907    0.0944
    1.0000    0.2285    0.1593    0.3304
    1.0000    0.0989    0.1945    0.0236
    1.0000    0.1315    0.0152    0.2864
    1.0000    0.1949    0.1569    0.1992
    1.0000    0.0952    0.1678    0.2235
    1.0000    0.0999    0.1184    0.1636
    1.0000    0.0985    0.2204    0.3345
    1.0000    0.1510    0.0885    0.3458
    1.0000    0.2804    0.0616    0.0993
    1.0000    0.2630    0.1375    0.2667
    1.0000    0.2450    0.2254    0.1060
    1.0000    0.1832    0.1324    0.3166
    1.0000    0.2708    0.1977    0.0873
    1.0000    0.1414    0.2760    0.3011
    1.0000    0.0980    0.2420    0.3869
    1.0000    0.1128    0.3175    0.0102
    1.0000    0.1888    0.2723    0.0654


rho =

   -0.3000


Beta =

    0.3000
   -4.0000
   -2.0000
    3.0000


Y =

     1
     0
     1
     0
     0
     0
     1
     0
     0
     0
     1
     1
     1
     1
     1
     0
     1
     0
     0
     0
     1
     0
     1
     0
     0
     1
     1
     0
     1
     0
     1
     0
     1
     1
     1
     0
     0
     1
     0
     1
     1
     0
     0
     0
     0
     1
     1
     1
     0
     0


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]
    info: [1&times;1 struct]


sims = 

  struct with fields:

    data: [1&times;1 struct]
    info: [1&times;1 struct]


N =

   100


X =

    1.0000    0.1429    0.1307    0.1818
    1.0000    0.2908    0.3454    0.1463
    1.0000    0.2495    0.3183    0.1445
    1.0000    0.2971    0.1971    0.3823
    1.0000    0.1258    0.2081    0.2613
    1.0000    0.1101    0.1725    0.1673
    1.0000    0.2798    0.1234    0.1521
    1.0000    0.0951    0.0370    0.1631
    1.0000    0.0966    0.1099    0.3877
    1.0000    0.1996    0.0309    0.2856
    1.0000    0.0997    0.1147    0.0538
    1.0000    0.1641    0.0663    0.0497
    1.0000    0.2271    0.2867    0.0529
    1.0000    0.1744    0.3134    0.2155
    1.0000    0.0897    0.3187    0.1747
    1.0000    0.1227    0.3376    0.3733
    1.0000    0.1783    0.1675    0.3789
    1.0000    0.0938    0.1695    0.2694
    1.0000    0.1455    0.3453    0.3364
    1.0000    0.2876    0.1154    0.3666
    1.0000    0.1422    0.1835    0.2121
    1.0000    0.1389    0.0909    0.3535
    1.0000    0.1696    0.1444    0.0624
    1.0000    0.2617    0.2073    0.1289
    1.0000    0.1915    0.1163    0.3769
    1.0000    0.1393    0.3385    0.1481
    1.0000    0.1548    0.3432    0.0784
    1.0000    0.2944    0.0605    0.2512
    1.0000    0.1205    0.1013    0.0546
    1.0000    0.1333    0.1654    0.2562
    1.0000    0.2319    0.0243    0.0533
    1.0000    0.1645    0.0630    0.3495
    1.0000    0.1815    0.0836    0.2504
    1.0000    0.2285    0.2893    0.1943
    1.0000    0.0989    0.0218    0.3004
    1.0000    0.1315    0.2509    0.1588
    1.0000    0.1949    0.1750    0.3597
    1.0000    0.0952    0.1961    0.0841
    1.0000    0.0999    0.1439    0.3951
    1.0000    0.0985    0.2929    0.0939
    1.0000    0.1510    0.3028    0.0202
    1.0000    0.2804    0.0879    0.3454
    1.0000    0.2630    0.2338    0.3106
    1.0000    0.2450    0.0937    0.1337
    1.0000    0.1832    0.2773    0.2590
    1.0000    0.2708    0.0774    0.0110
    1.0000    0.1414    0.2638    0.3685
    1.0000    0.0980    0.3385    0.1007
    1.0000    0.1128    0.0102    0.2252
    1.0000    0.1888    0.0583    0.2763
    1.0000    0.1468    0.3466    0.0728
    1.0000    0.1464    0.0939    0.1058
    1.0000    0.0816    0.1326    0.2963
    1.0000    0.2075    0.1942    0.1616
    1.0000    0.2380    0.1686    0.1301
    1.0000    0.1696    0.0324    0.3316
    1.0000    0.1159    0.2543    0.2927
    1.0000    0.1263    0.0567    0.2096
    1.0000    0.2472    0.3324    0.0263
    1.0000    0.1587    0.0253    0.2650
    1.0000    0.1652    0.0531    0.2148
    1.0000    0.2459    0.2802    0.2774
    1.0000    0.2708    0.1679    0.3179
    1.0000    0.2449    0.3315    0.2250
    1.0000    0.1674    0.2806    0.3402
    1.0000    0.1724    0.1000    0.0550
    1.0000    0.2018    0.3180    0.2500
    1.0000    0.1824    0.1361    0.2631
    1.0000    0.2695    0.0897    0.0967
    1.0000    0.2612    0.0749    0.0998
    1.0000    0.0963    0.3270    0.3059
    1.0000    0.1505    0.0372    0.0609
    1.0000    0.1725    0.1777    0.0692
    1.0000    0.2255    0.0216    0.0413
    1.0000    0.2189    0.1866    0.2989
    1.0000    0.1933    0.1184    0.0909
    1.0000    0.1578    0.0547    0.1853
    1.0000    0.0893    0.0855    0.0573
    1.0000    0.0881    0.0967    0.3797
    1.0000    0.2517    0.0191    0.1948
    1.0000    0.1197    0.1780    0.2106
    1.0000    0.1686    0.0792    0.0585
    1.0000    0.2616    0.3291    0.2605
    1.0000    0.1766    0.2048    0.2997
    1.0000    0.1994    0.3169    0.2460
    1.0000    0.0834    0.0953    0.1264
    1.0000    0.1751    0.0658    0.3788
    1.0000    0.1821    0.2763    0.0485
    1.0000    0.1501    0.1061    0.1452
    1.0000    0.2161    0.1803    0.2996
    1.0000    0.1308    0.1968    0.1738
    1.0000    0.1134    0.0728    0.1193
    1.0000    0.1625    0.0664    0.1369
    1.0000    0.2194    0.0278    0.2211
    1.0000    0.1592    0.0486    0.2960
    1.0000    0.2014    0.2760    0.2005
    1.0000    0.2521    0.2980    0.3120
    1.0000    0.2301    0.1750    0.0790
    1.0000    0.2790    0.2060    0.1199
    1.0000    0.2497    0.0718    0.3504


rho =

   -0.3000


Beta =

    0.3000
   -4.0000
   -2.0000
    3.0000


Y =

     1
     0
     1
     0
     1
     0
     1
     1
     1
     0
     0
     1
     1
     0
     0
     1
     1
     0
     1
     0
     0
     1
     0
     1
     1
     0
     0
     1
     0
     1
     0
     1
     1
     0
     1
     0
     0
     0
     1
     0
     0
     1
     0
     0
     0
     1
     0
     0
     1
     1
     0
     1
     1
     0
     1
     1
     0
     1
     0
     1
     1
     0
     1
     1
     0
     1
     1
     1
     0
     0
     1
     1
     0
     0
     0
     0
     1
     1
     1
     0
     1
     0
     1
     1
     0
     1
     1
     0
     0
     0
     1
     0
     0
     1
     1
     1
     1
     1
     0
     0


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]
    info: [1&times;1 struct]


sims = 

  1&times;2 struct array with fields:

    data
    info


N =

   500


X =

    1.0000    0.1429    0.2112    0.2497
    1.0000    0.2908    0.2856    0.2907
    1.0000    0.2495    0.2839    0.0970
    1.0000    0.2971    0.3183    0.1849
    1.0000    0.1258    0.0513    0.0327
    1.0000    0.1101    0.2917    0.3538
    1.0000    0.2798    0.1097    0.3462
    1.0000    0.0951    0.2608    0.2460
    1.0000    0.0966    0.1822    0.2909
    1.0000    0.1996    0.3335    0.3370
    1.0000    0.0997    0.0955    0.0252
    1.0000    0.1641    0.0325    0.0393
    1.0000    0.2271    0.1110    0.2623
    1.0000    0.1744    0.2375    0.2122
    1.0000    0.0897    0.0244    0.0332
    1.0000    0.1227    0.3250    0.2037
    1.0000    0.1783    0.2397    0.1659
    1.0000    0.0938    0.1716    0.1901
    1.0000    0.1455    0.1371    0.3859
    1.0000    0.2876    0.0134    0.1105
    1.0000    0.1422    0.0336    0.2326
    1.0000    0.1389    0.1486    0.0305
    1.0000    0.1696    0.1382    0.3352
    1.0000    0.2617    0.2296    0.0957
    1.0000    0.1915    0.2251    0.1878
    1.0000    0.1393    0.1487    0.2879
    1.0000    0.1548    0.3456    0.0423
    1.0000    0.2944    0.2291    0.2820
    1.0000    0.1205    0.3358    0.0461
    1.0000    0.1333    0.2230    0.0692
    1.0000    0.2319    0.2162    0.1597
    1.0000    0.1645    0.2585    0.2911
    1.0000    0.1815    0.3262    0.3724
    1.0000    0.2285    0.0948    0.1702
    1.0000    0.0989    0.2866    0.2054
    1.0000    0.1315    0.3209    0.0463
    1.0000    0.1949    0.1210    0.3110
    1.0000    0.0952    0.2130    0.2924
    1.0000    0.0999    0.0728    0.2753
    1.0000    0.0985    0.1937    0.2652
    1.0000    0.1510    0.0648    0.0287
    1.0000    0.2804    0.1598    0.0390
    1.0000    0.2630    0.1687    0.2094
    1.0000    0.2450    0.2476    0.2576
    1.0000    0.1832    0.1783    0.0865
    1.0000    0.2708    0.3013    0.0765
    1.0000    0.1414    0.0742    0.3969
    1.0000    0.0980    0.0486    0.1710
    1.0000    0.1128    0.2090    0.2245
    1.0000    0.1888    0.1393    0.2877
    1.0000    0.1468    0.2062    0.1910
    1.0000    0.1464    0.2717    0.1071
    1.0000    0.0816    0.2721    0.0725
    1.0000    0.2075    0.3239    0.0280
    1.0000    0.2380    0.2601    0.0788
    1.0000    0.1696    0.3111    0.2408
    1.0000    0.1159    0.3493    0.1819
    1.0000    0.1263    0.0788    0.2453
    1.0000    0.2472    0.2166    0.3516
    1.0000    0.1587    0.3166    0.3280
    1.0000    0.1652    0.0791    0.0948
    1.0000    0.2459    0.2444    0.2418
    1.0000    0.2708    0.0293    0.1745
    1.0000    0.2449    0.1711    0.3046
    1.0000    0.1674    0.2974    0.2482
    1.0000    0.1724    0.2856    0.0772
    1.0000    0.2018    0.2585    0.1330
    1.0000    0.1824    0.1606    0.2945
    1.0000    0.2695    0.0533    0.0232
    1.0000    0.2612    0.0821    0.0778
    1.0000    0.0963    0.0977    0.1925
    1.0000    0.1505    0.3398    0.2537
    1.0000    0.1725    0.3439    0.3745
    1.0000    0.2255    0.2514    0.3616
    1.0000    0.2189    0.3062    0.2195
    1.0000    0.1933    0.1639    0.2908
    1.0000    0.1578    0.3358    0.2602
    1.0000    0.0893    0.2333    0.2602
    1.0000    0.0881    0.1225    0.2601
    1.0000    0.2517    0.2484    0.3931
    1.0000    0.1197    0.1669    0.3630
    1.0000    0.1686    0.1413    0.2058
    1.0000    0.2616    0.3128    0.2010
    1.0000    0.1766    0.0530    0.1129
    1.0000    0.1994    0.3042    0.2396
    1.0000    0.0834    0.1391    0.1737
    1.0000    0.1751    0.1038    0.1127
    1.0000    0.1821    0.2874    0.2075
    1.0000    0.1501    0.2218    0.2423
    1.0000    0.2161    0.0352    0.1210
    1.0000    0.1308    0.0944    0.1897
    1.0000    0.1134    0.0148    0.3890
    1.0000    0.1625    0.2012    0.1459
    1.0000    0.2194    0.1530    0.0896
    1.0000    0.1592    0.1440    0.2616
    1.0000    0.2014    0.0488    0.2600
    1.0000    0.2521    0.1341    0.1327
    1.0000    0.2301    0.0750    0.1138
    1.0000    0.2790    0.3368    0.0198
    1.0000    0.2497    0.1159    0.0136
    1.0000    0.1581    0.0672    0.3220
    1.0000    0.2970    0.0325    0.1715
    1.0000    0.2795    0.2195    0.1301
    1.0000    0.2010    0.2247    0.3556
    1.0000    0.2082    0.1846    0.1436
    1.0000    0.1852    0.2873    0.3256
    1.0000    0.1534    0.0662    0.2276
    1.0000    0.0975    0.2737    0.2996
    1.0000    0.1446    0.0949    0.0335
    1.0000    0.0935    0.1789    0.2440
    1.0000    0.1477    0.1690    0.1453
    1.0000    0.1164    0.2231    0.3261
    1.0000    0.2590    0.2951    0.0805
    1.0000    0.2763    0.0554    0.2498
    1.0000    0.2798    0.0441    0.3259
    1.0000    0.2920    0.3358    0.0658
    1.0000    0.1819    0.0655    0.0300
    1.0000    0.1832    0.3289    0.0252
    1.0000    0.2969    0.2869    0.1813
    1.0000    0.1482    0.3469    0.3127
    1.0000    0.1923    0.2360    0.3591
    1.0000    0.1324    0.3411    0.2787
    1.0000    0.1670    0.0772    0.3003
    1.0000    0.2077    0.1882    0.2315
    1.0000    0.1488    0.2084    0.2944
    1.0000    0.2926    0.3355    0.3646
    1.0000    0.2956    0.1358    0.0756
    1.0000    0.1127    0.2353    0.0926
    1.0000    0.1391    0.0719    0.0287
    1.0000    0.1806    0.3127    0.2249
    1.0000    0.0893    0.3215    0.1638
    1.0000    0.1143    0.2363    0.1412
    1.0000    0.1276    0.3040    0.2489
    1.0000    0.2607    0.2249    0.1887
    1.0000    0.0877    0.3434    0.1891
    1.0000    0.2359    0.0776    0.0140
    1.0000    0.1867    0.2321    0.0632
    1.0000    0.2004    0.1465    0.2428
    1.0000    0.1666    0.0665    0.1710
    1.0000    0.2631    0.2792    0.0370
    1.0000    0.2694    0.3164    0.2768
    1.0000    0.1304    0.2029    0.2082
    1.0000    0.2248    0.2519    0.0572
    1.0000    0.1341    0.1199    0.1215
    1.0000    0.2529    0.1886    0.2944
    1.0000    0.1236    0.2230    0.2311
    1.0000    0.2442    0.3195    0.2151
    1.0000    0.2926    0.0239    0.1453
    1.0000    0.0801    0.1253    0.2758
    1.0000    0.1112    0.1471    0.0958
    1.0000    0.2978    0.2454    0.3054
    1.0000    0.1343    0.2460    0.1112
    1.0000    0.1594    0.2027    0.2496
    1.0000    0.1992    0.0602    0.1148
    1.0000    0.1826    0.2990    0.1848
    1.0000    0.0945    0.2804    0.3307
    1.0000    0.2381    0.1536    0.2580
    1.0000    0.1102    0.0515    0.1811
    1.0000    0.2886    0.3006    0.0391
    1.0000    0.0899    0.0819    0.2351
    1.0000    0.1079    0.1642    0.2445
    1.0000    0.2548    0.2590    0.3564
    1.0000    0.1822    0.2146    0.3463
    1.0000    0.2880    0.3132    0.0991
    1.0000    0.2551    0.0659    0.3791
    1.0000    0.1382    0.2335    0.0214
    1.0000    0.2793    0.0128    0.2240
    1.0000    0.1616    0.0498    0.0305
    1.0000    0.1316    0.2812    0.3421
    1.0000    0.1220    0.2415    0.2272
    1.0000    0.2851    0.2513    0.2961
    1.0000    0.0976    0.1433    0.1448
    1.0000    0.1885    0.2395    0.3131
    1.0000    0.0875    0.1585    0.2495
    1.0000    0.1943    0.0168    0.0636
    1.0000    0.1502    0.1191    0.1738
    1.0000    0.1089    0.2872    0.3336
    1.0000    0.1289    0.3431    0.1228
    1.0000    0.1361    0.2230    0.3742
    1.0000    0.0859    0.0901    0.3852
    1.0000    0.1887    0.2062    0.1716
    1.0000    0.1248    0.2736    0.3692
    1.0000    0.2865    0.2201    0.2415
    1.0000    0.2060    0.2919    0.1195
    1.0000    0.2786    0.3429    0.0129
    1.0000    0.1352    0.2840    0.2367
    1.0000    0.1161    0.0325    0.2887
    1.0000    0.2523    0.0881    0.1770
    1.0000    0.1422    0.2126    0.1459
    1.0000    0.1902    0.1167    0.1279
    1.0000    0.2008    0.3064    0.1626
    1.0000    0.1206    0.1983    0.1209
    1.0000    0.1165    0.1207    0.3048
    1.0000    0.0915    0.1406    0.2956
    1.0000    0.1050    0.0509    0.2905
    1.0000    0.2521    0.2389    0.0249
    1.0000    0.2663    0.1815    0.3364
    1.0000    0.1868    0.3077    0.1660
    1.0000    0.2068    0.0557    0.3677
    1.0000    0.1200    0.0521    0.3329
    1.0000    0.1769    0.1200    0.0310
    1.0000    0.1569    0.2680    0.3515
    1.0000    0.1559    0.2476    0.3625
    1.0000    0.2900    0.1500    0.1537
    1.0000    0.2218    0.1768    0.2235
    1.0000    0.1687    0.1194    0.1488
    1.0000    0.1602    0.0805    0.0631
    1.0000    0.1663    0.3277    0.2135
    1.0000    0.2931    0.1633    0.1289
    1.0000    0.2355    0.3248    0.2379
    1.0000    0.1047    0.2283    0.1227
    1.0000    0.1024    0.1415    0.2725
    1.0000    0.1042    0.3240    0.1780
    1.0000    0.1960    0.2454    0.0226
    1.0000    0.1729    0.0161    0.3797
    1.0000    0.2849    0.1040    0.0525
    1.0000    0.2881    0.0264    0.1789
    1.0000    0.2264    0.0961    0.0586
    1.0000    0.2641    0.3261    0.3797
    1.0000    0.2811    0.1777    0.3832
    1.0000    0.1940    0.1578    0.0902
    1.0000    0.2738    0.1436    0.1201
    1.0000    0.1095    0.1289    0.0927
    1.0000    0.1470    0.2623    0.1096
    1.0000    0.2870    0.2682    0.3341
    1.0000    0.1579    0.0296    0.2193
    1.0000    0.1186    0.1342    0.2176
    1.0000    0.2160    0.2763    0.2745
    1.0000    0.1052    0.0356    0.2267
    1.0000    0.2189    0.3172    0.2127
    1.0000    0.1044    0.1486    0.1369
    1.0000    0.2715    0.1010    0.0417
    1.0000    0.2156    0.3111    0.3507
    1.0000    0.1840    0.3489    0.0173
    1.0000    0.2438    0.3071    0.3193
    1.0000    0.1639    0.0743    0.0179
    1.0000    0.2772    0.0275    0.3404
    1.0000    0.1218    0.1097    0.1206
    1.0000    0.2972    0.3043    0.1826
    1.0000    0.1274    0.3075    0.3539
    1.0000    0.0858    0.0243    0.0641
    1.0000    0.2692    0.2639    0.0281
    1.0000    0.2496    0.2867    0.3086
    1.0000    0.1498    0.0428    0.0566
    1.0000    0.2205    0.2948    0.3545
    1.0000    0.0806    0.1939    0.0482
    1.0000    0.2822    0.0966    0.2309
    1.0000    0.1312    0.1182    0.0357
    1.0000    0.2014    0.1709    0.3382
    1.0000    0.2302    0.3086    0.1506
    1.0000    0.1154    0.0393    0.0163
    1.0000    0.1340    0.2100    0.2905
    1.0000    0.2415    0.1873    0.3405
    1.0000    0.1655    0.0552    0.0189
    1.0000    0.1478    0.1843    0.1095
    1.0000    0.2614    0.1902    0.0664
    1.0000    0.2395    0.3183    0.1174
    1.0000    0.1926    0.2474    0.3015
    1.0000    0.0892    0.0357    0.0738
    1.0000    0.2239    0.2619    0.3512
    1.0000    0.1955    0.2629    0.0104
    1.0000    0.2308    0.0170    0.3294
    1.0000    0.2537    0.1726    0.0153
    1.0000    0.2013    0.0765    0.2132
    1.0000    0.2663    0.2903    0.3261
    1.0000    0.1054    0.3010    0.1046
    1.0000    0.2154    0.2941    0.2667
    1.0000    0.2227    0.2944    0.2376
    1.0000    0.1289    0.2767    0.3073
    1.0000    0.1306    0.1130    0.1062
    1.0000    0.2469    0.1919    0.2548
    1.0000    0.1087    0.2702    0.3726
    1.0000    0.1134    0.2882    0.1942
    1.0000    0.0977    0.0384    0.0538
    1.0000    0.2430    0.1309    0.1471
    1.0000    0.1256    0.0698    0.3041
    1.0000    0.1789    0.1343    0.1324
    1.0000    0.1067    0.3167    0.0300
    1.0000    0.2886    0.2185    0.3636
    1.0000    0.1842    0.1478    0.2998
    1.0000    0.1931    0.2609    0.0513
    1.0000    0.1074    0.2824    0.3928
    1.0000    0.2213    0.2180    0.3488
    1.0000    0.2434    0.0531    0.0150
    1.0000    0.2131    0.3129    0.1650
    1.0000    0.1456    0.2329    0.1687
    1.0000    0.2880    0.0868    0.2693
    1.0000    0.1017    0.0451    0.3771
    1.0000    0.1562    0.2067    0.2429
    1.0000    0.2434    0.1997    0.2884
    1.0000    0.1724    0.0217    0.1181
    1.0000    0.1416    0.2944    0.2501
    1.0000    0.1516    0.2736    0.2118
    1.0000    0.1991    0.0369    0.1564
    1.0000    0.2413    0.2626    0.1849
    1.0000    0.1875    0.1822    0.0981
    1.0000    0.2503    0.3301    0.0357
    1.0000    0.1189    0.3045    0.1994
    1.0000    0.1420    0.1026    0.1779
    1.0000    0.2720    0.0368    0.3018
    1.0000    0.1976    0.0477    0.3848
    1.0000    0.1561    0.0467    0.1586
    1.0000    0.2658    0.2633    0.1391
    1.0000    0.0908    0.3014    0.3640
    1.0000    0.2726    0.1961    0.3111
    1.0000    0.1933    0.0764    0.1947
    1.0000    0.2362    0.3449    0.2683
    1.0000    0.1425    0.1254    0.0864
    1.0000    0.0860    0.3120    0.0241
    1.0000    0.0864    0.0560    0.3517
    1.0000    0.1504    0.2906    0.2110
    1.0000    0.2796    0.3162    0.0242
    1.0000    0.2898    0.2760    0.2145
    1.0000    0.1281    0.1957    0.0806
    1.0000    0.1234    0.1132    0.3077
    1.0000    0.2467    0.0875    0.2098
    1.0000    0.2605    0.2420    0.3112
    1.0000    0.0884    0.2721    0.2314
    1.0000    0.2268    0.0323    0.0240
    1.0000    0.2441    0.1170    0.1033
    1.0000    0.2206    0.0832    0.3819
    1.0000    0.2738    0.3163    0.0733
    1.0000    0.1146    0.0265    0.3115
    1.0000    0.1759    0.1961    0.0245
    1.0000    0.2844    0.0916    0.1137
    1.0000    0.1309    0.3263    0.0137
    1.0000    0.2659    0.1274    0.3485
    1.0000    0.2490    0.0874    0.0570
    1.0000    0.1533    0.0900    0.2065
    1.0000    0.2862    0.1926    0.0436
    1.0000    0.1634    0.0684    0.1913
    1.0000    0.2248    0.1740    0.3832
    1.0000    0.2021    0.2548    0.2226
    1.0000    0.2772    0.1168    0.0572
    1.0000    0.1448    0.2103    0.3602
    1.0000    0.1760    0.1258    0.0297
    1.0000    0.1583    0.2563    0.3637
    1.0000    0.1140    0.3102    0.1772
    1.0000    0.2595    0.2526    0.1685
    1.0000    0.1710    0.2671    0.3097
    1.0000    0.1834    0.0220    0.1948
    1.0000    0.2266    0.0976    0.3288
    1.0000    0.1134    0.0140    0.0892
    1.0000    0.1033    0.2612    0.0423
    1.0000    0.2761    0.3104    0.2313
    1.0000    0.1158    0.0197    0.1692
    1.0000    0.1026    0.1968    0.2192
    1.0000    0.0896    0.0446    0.3152
    1.0000    0.1589    0.0490    0.2204
    1.0000    0.2296    0.3183    0.2525
    1.0000    0.2918    0.3479    0.0259
    1.0000    0.2600    0.2428    0.3457
    1.0000    0.2830    0.0464    0.0950
    1.0000    0.1550    0.1776    0.1099
    1.0000    0.2900    0.1400    0.2464
    1.0000    0.2571    0.0798    0.1537
    1.0000    0.1407    0.1218    0.0517
    1.0000    0.2588    0.1470    0.0167
    1.0000    0.1723    0.1395    0.2079
    1.0000    0.1770    0.3090    0.2734
    1.0000    0.1740    0.1410    0.2237
    1.0000    0.1427    0.2416    0.3633
    1.0000    0.2516    0.2935    0.3981
    1.0000    0.2191    0.3160    0.1532
    1.0000    0.1303    0.1385    0.1338
    1.0000    0.2844    0.1374    0.2844
    1.0000    0.2371    0.0337    0.0253
    1.0000    0.1953    0.1926    0.3153
    1.0000    0.1504    0.1912    0.1401
    1.0000    0.1227    0.3030    0.3034
    1.0000    0.1913    0.2323    0.3013
    1.0000    0.2771    0.2630    0.1747
    1.0000    0.1746    0.1306    0.0576
    1.0000    0.1827    0.3201    0.0814
    1.0000    0.0899    0.1960    0.2203
    1.0000    0.2243    0.1486    0.1987
    1.0000    0.1321    0.2047    0.1584
    1.0000    0.1914    0.3008    0.0598
    1.0000    0.2283    0.1122    0.2352
    1.0000    0.2530    0.1740    0.1917
    1.0000    0.1410    0.0695    0.0344
    1.0000    0.1869    0.2397    0.0937
    1.0000    0.2545    0.1838    0.3317
    1.0000    0.1783    0.2075    0.0602
    1.0000    0.1329    0.2487    0.1201
    1.0000    0.2348    0.3168    0.3298
    1.0000    0.2477    0.0890    0.1369
    1.0000    0.2113    0.0877    0.2872
    1.0000    0.0804    0.0535    0.0127
    1.0000    0.1696    0.1742    0.0536
    1.0000    0.1498    0.2154    0.2385
    1.0000    0.2683    0.0785    0.0409
    1.0000    0.0806    0.3127    0.2197
    1.0000    0.1602    0.3383    0.3023
    1.0000    0.2015    0.2271    0.2365
    1.0000    0.1166    0.1445    0.0547
    1.0000    0.2627    0.2995    0.2254
    1.0000    0.1766    0.2869    0.3533
    1.0000    0.2615    0.0946    0.3484
    1.0000    0.2769    0.0301    0.3390
    1.0000    0.1754    0.2820    0.2488
    1.0000    0.1740    0.0697    0.2652
    1.0000    0.1922    0.0723    0.2602
    1.0000    0.1985    0.0851    0.2072
    1.0000    0.2211    0.1359    0.1020
    1.0000    0.2168    0.0674    0.1143
    1.0000    0.2634    0.2095    0.2062
    1.0000    0.0980    0.0570    0.3844
    1.0000    0.0903    0.1173    0.1148
    1.0000    0.1048    0.2231    0.3685
    1.0000    0.1534    0.2965    0.2999
    1.0000    0.1558    0.3165    0.2265
    1.0000    0.1593    0.1450    0.2396
    1.0000    0.0830    0.0880    0.2973
    1.0000    0.1628    0.2596    0.1877
    1.0000    0.2207    0.1602    0.2431
    1.0000    0.1623    0.2062    0.3281
    1.0000    0.2747    0.0169    0.2109
    1.0000    0.1571    0.3445    0.0126
    1.0000    0.1754    0.1927    0.0397
    1.0000    0.2382    0.3421    0.0332
    1.0000    0.2687    0.3193    0.3503
    1.0000    0.2792    0.3465    0.1285
    1.0000    0.1131    0.1314    0.1795
    1.0000    0.0890    0.0128    0.0594
    1.0000    0.2173    0.3117    0.2259
    1.0000    0.2909    0.3031    0.3781
    1.0000    0.2465    0.0448    0.0491
    1.0000    0.2101    0.1472    0.0644
    1.0000    0.1456    0.2241    0.0511
    1.0000    0.2228    0.0631    0.0213
    1.0000    0.1512    0.2827    0.3582
    1.0000    0.1749    0.0829    0.1316
    1.0000    0.1128    0.2820    0.3424
    1.0000    0.2784    0.0735    0.2680
    1.0000    0.1836    0.1008    0.2704
    1.0000    0.2166    0.2573    0.3935
    1.0000    0.2646    0.3444    0.2977
    1.0000    0.2528    0.2363    0.0228
    1.0000    0.1339    0.2908    0.0163
    1.0000    0.2269    0.0665    0.0465
    1.0000    0.1429    0.0321    0.1743
    1.0000    0.1480    0.3250    0.3991
    1.0000    0.2390    0.0557    0.2129
    1.0000    0.1540    0.2861    0.2138
    1.0000    0.2477    0.3105    0.3224
    1.0000    0.0818    0.0169    0.3816
    1.0000    0.1356    0.0814    0.3930
    1.0000    0.2249    0.3240    0.3152
    1.0000    0.1366    0.1693    0.3912
    1.0000    0.1507    0.2058    0.1588
    1.0000    0.2511    0.2681    0.2088
    1.0000    0.0828    0.2222    0.2377
    1.0000    0.2340    0.1761    0.1873
    1.0000    0.1820    0.0395    0.2556
    1.0000    0.1845    0.3349    0.1416
    1.0000    0.1850    0.0618    0.0373
    1.0000    0.2312    0.1637    0.2457
    1.0000    0.2416    0.1359    0.3247
    1.0000    0.2085    0.1599    0.1697
    1.0000    0.1516    0.1997    0.0815
    1.0000    0.1735    0.0881    0.2975
    1.0000    0.1406    0.2616    0.1667
    1.0000    0.0921    0.0446    0.3890
    1.0000    0.0918    0.1079    0.1389
    1.0000    0.2119    0.3390    0.3505
    1.0000    0.1668    0.1209    0.0757
    1.0000    0.1902    0.2120    0.0185
    1.0000    0.1094    0.2221    0.1317
    1.0000    0.1331    0.2445    0.3168
    1.0000    0.2328    0.1550    0.3913
    1.0000    0.1010    0.1909    0.2304
    1.0000    0.0874    0.3421    0.0353
    1.0000    0.2653    0.1382    0.3197
    1.0000    0.1452    0.1370    0.3408
    1.0000    0.1640    0.0920    0.3014
    1.0000    0.1953    0.3050    0.3470
    1.0000    0.1123    0.0974    0.3118
    1.0000    0.0975    0.1657    0.3351
    1.0000    0.1370    0.2454    0.2534
    1.0000    0.2545    0.1272    0.3164
    1.0000    0.1003    0.3001    0.3776
    1.0000    0.2526    0.1268    0.2595
    1.0000    0.1455    0.2023    0.0975
    1.0000    0.1056    0.1596    0.3895
    1.0000    0.2885    0.1051    0.3989
    1.0000    0.1758    0.1877    0.2561
    1.0000    0.2015    0.1548    0.2116
    1.0000    0.1743    0.1200    0.3886
    1.0000    0.0910    0.1762    0.3788
    1.0000    0.2872    0.2825    0.2331
    1.0000    0.2606    0.1333    0.2090
    1.0000    0.1355    0.2675    0.1753
    1.0000    0.1666    0.0604    0.2734
    1.0000    0.1077    0.0291    0.2530
    1.0000    0.1634    0.2776    0.2260
    1.0000    0.2183    0.3420    0.0940
    1.0000    0.1149    0.1151    0.1870
    1.0000    0.1557    0.0582    0.3070
    1.0000    0.2963    0.2280    0.3692


rho =

   -0.3000


Beta =

    0.3000
   -4.0000
   -2.0000
    3.0000


Y =

     0
     1
     1
     0
     1
     1
     0
     0
     0
     0
     0
     0
     1
     0
     1
     1
     1
     0
     0
     0
     1
     1
     0
     0
     0
     0
     0
     0
     0
     0
     1
     0
     1
     0
     1
     0
     0
     1
     1
     1
     0
     1
     0
     0
     0
     0
     1
     1
     1
     0
     0
     0
     0
     0
     0
     1
     1
     0
     0
     0
     0
     0
     0
     1
     0
     0
     0
     1
     0
     0
     0
     0
     1
     1
     1
     0
     0
     0
     0
     1
     1
     1
     0
     1
     0
     0
     1
     1
     0
     1
     1
     0
     1
     0
     1
     0
     0
     0
     1
     0
     1
     0
     0
     1
     0
     0
     1
     0
     1
     0
     1
     0
     0
     1
     0
     0
     0
     1
     0
     1
     1
     1
     1
     1
     1
     0
     0
     1
     0
     0
     0
     1
     0
     1
     1
     0
     1
     0
     1
     1
     0
     0
     0
     0
     1
     1
     0
     1
     1
     0
     1
     1
     1
     0
     1
     0
     1
     1
     0
     0
     1
     1
     1
     0
     0
     1
     0
     0
     0
     1
     0
     0
     1
     1
     0
     0
     0
     0
     1
     1
     1
     1
     0
     1
     0
     1
     1
     0
     1
     1
     0
     1
     1
     0
     1
     0
     0
     1
     1
     1
     0
     1
     1
     0
     0
     0
     0
     1
     1
     0
     1
     0
     1
     0
     0
     0
     0
     0
     1
     0
     0
     1
     0
     1
     1
     0
     0
     1
     1
     1
     0
     0
     1
     0
     1
     0
     0
     1
     0
     0
     0
     0
     0
     1
     0
     1
     1
     0
     0
     0
     0
     0
     0
     0
     1
     0
     0
     0
     0
     1
     0
     1
     0
     1
     0
     1
     0
     0
     1
     0
     1
     1
     0
     0
     0
     1
     1
     0
     0
     1
     1
     0
     1
     0
     0
     0
     0
     1
     1
     0
     0
     1
     1
     0
     1
     1
     0
     0
     1
     1
     1
     0
     0
     1
     0
     0
     1
     0
     1
     0
     0
     0
     0
     1
     1
     0
     1
     1
     0
     0
     1
     0
     1
     0
     0
     0
     1
     0
     0
     0
     1
     1
     0
     1
     1
     0
     0
     1
     0
     1
     1
     0
     0
     1
     0
     0
     0
     1
     1
     0
     1
     0
     0
     1
     1
     0
     1
     0
     0
     0
     1
     0
     0
     0
     1
     0
     1
     1
     1
     1
     1
     0
     0
     0
     1
     1
     1
     0
     1
     0
     1
     0
     0
     0
     0
     1
     1
     0
     0
     0
     0
     0
     0
     0
     0
     0
     0
     1
     1
     1
     0
     1
     0
     1
     0
     0
     0
     1
     0
     1
     0
     0
     0
     1
     1
     0
     1
     1
     0
     0
     0
     0
     1
     1
     1
     0
     0
     0
     0
     0
     0
     1
     0
     1
     0
     1
     1
     0
     0
     1
     0
     0
     0
     1
     0
     1
     1
     1
     0
     1
     1
     0
     1
     1
     1
     0
     1
     0
     0
     0
     0
     1
     1
     1
     0
     1
     1
     0
     0
     1
     0
     1
     0
     0
     1
     1
     1
     1
     1
     0
     1
     0
     1
     0
     1
     1
     0
     1
     1
     1
     0
     0
     1
     1
     1
     0
     0
     0
     1
     0


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]


sim = 

  struct with fields:

    data: [1&times;1 struct]
    info: [1&times;1 struct]


sims = 

  1&times;3 struct array with fields:

    data
    info

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
% Simulate a probit SAR model
% Input is a graph matrix (W) that was generated in R using network_sim.Rmd
% y* := Pr[y=1|x] = F(x'beta)
% i = random binary vector
% Y := round((y* * i))

% x = [capital liquidity shortFunding]

load('..\SAR_sim\Ws.mat')
Ws(1) = s1
Ws(2) = s2
Ws(3) = s3

for i=1:length(Ws)
    sims(i) = sim_probit_SAR(Ws(i).W)
end

save('sims_probit_SAR_Wfull.mat','sims')

function sim = sim_probit_SAR(W)
    N = size(W, 1)

    %normalize W
    for i=1:size(W,1)
        if sum(W(i,:))~=0
            W(i,:) = W(i,:)/sum(W(i,:));
        end
    end

    rng(31, 'twister');
    capital = unifrnd(0.08, 0.30, [N 1]);
    liquidity = unifrnd(0.01, 0.35, [N 1]);
    shortFunding = unifrnd(0.01, 0.40, [N 1]);
    X = [ones(N, 1) capital liquidity shortFunding]
    rho = -0.3
    Beta = [0.3 
            -4 
            -2
            3]
    Epsilon = random('Normal', 0, 1, N, 1);
    I = eye(N);
    A = (I - rho*W)^(-1);
    Y_p = normcdf(A*X*Beta + A*Epsilon);
    
    Y = binornd(1, Y_p)
    
    sim.data.X = X
    sim.data.Y = Y
    sim.data.W = W
    sim.info.gamma = [Beta 
                    rho]
               
end
% end simulation
##### SOURCE END #####
--></body></html>